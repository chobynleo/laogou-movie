"use strict";$.support.cors=!0,$(function(){function e(e,t,i){$.ajax({url:e,cache:!0,type:t,crossDomain:!0}).done(i)}(function(){var t=$(".col-md-6").width();(function(){function i(e){var i=(c-1)*t;$("#screenBody").is(":animated")||("right"===e?l===c?(l=1,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:0},500)):(l++,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:"-="+t},500)):1===l?(l=c,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:"-="+i},500)):(l--,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:"+="+t},500)))}var n=($("#scrollMoives .panel"),$("#headerNow span")),l=1,s=$("#scrollMoives .slide-prev"),a=$("#scrollMoives .slide-next"),o=$("#scrollMoives .thumbnail"),r=o.length,c=Math.ceil(r/4);$("#scrollMoives .side-max").html(c),$("#screenBody").width(t*c);var d=o.outerWidth(!0)-o.outerWidth(),h=(t-4*d)/4;o.width(h),n.on("click",function(){var i=$(this).text(),s="/?galleryName="+encodeURIComponent(i);e(s,"GET",function(e){var s=e.data||[],a=s.movies,d=s.movies.length;if($("#headerNow a").attr("href","/movie/results?cat="+s._id+"&p=0").text(s.name),"即将上映"===i?n.text("正在上映"):n.text("即将上映"),d<o.length)$("#scrollMoives .thumbnail:gt("+(d-1)+")").remove();else if(d>o.length){for(var m=o.length;d>m;m++)$("#screenBody").append('<div class="thumbnail"><a href="" target="_blank"><img src="" alt="" /></a><div class="caption"><h5></h5><p><a class="btn btn-primary" href="" role="button">观看预告片</a></p></div></div>');$("#screenBody .thumbnail:gt("+(o.length-1)+")").width(h)}o=$("#scrollMoives .thumbnail"),r=o.length,c=Math.ceil(r/4),$("#scrollMoives .side-max").html(c),$("#screenBody").width(t*c);for(var f=0;f<o.length;f++)if(a[f]){$(o[f]).find("a").attr("href","/movie/"+a[f]._id),$(o[f]).find("h5").html(a[f].title);var v=$(o[f]).find("img");a[f].poster&&(a[f].poster.indexOf("http:")>-1?v.attr("src",a[f].poster).attr("alt",a[f].poster):v.attr("src","/upload/movie/"+a[f].poster).attr("alt",a[f].poster))}l>c&&(l=c,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:-t*(l-1)},0))})}),a.on("click",function(){i("right")}),s.on("click",function(){i("left")});var m=setInterval(function(){i("right")},5e3);$("#scrollMoives").on("mouseover",function(){clearInterval(m)}).on("mouseout",function(){m=setInterval(function(){i("right")},5e3)})})();$("#fliterMovies .class-top").on("click","button",function(){if(!$(this).is(".btn-primary")){var t=$(this).html(),i="/?fliterName="+encodeURIComponent(t+"电影");e(i,"GET",function(e){if(null===e.data||0===e.data.movies.length)$("#classBody").html("");else{var t=e.data.movies,i=$("#classBody .thumbnail"),n=t.length-1;if(t.length<i.length)$("#fliterMovies .col-md-3:gt("+n+")").remove();else if(t.length>i.length)for(var l=i.length;l<t.length;l++)$("#classBody").append('<div class="col-md-3"><div class="thumbnail"><a href=""><img src="" alt="" /></a><div class="caption"><h5></h5></div></div></div>');i=$("#classBody .thumbnail");for(var s=0;s<i.length;s++)if(t[s]){$(i[s]).find("a").attr("href","/movie/"+t[s]._id),$(i[s]).find("h5").html(t[s].title);var a=$(i[s]).find("img");t[s].poster&&(t[s].poster.indexOf("http:")>-1?a.attr("src",t[s].poster).attr("alt",t[s].poster):a.attr("src","/upload/movie/"+t[s].poster).attr("alt",t[s].poster))}}}),$(this).addClass("btn-primary").removeClass("btn-default").parent().siblings().children().addClass("btn-default").removeClass("btn-primary")}});(function(){function e(e){a.is(":animated")||("right"===e?(i++,$("#galleryFrames .side-index").html(i),a.animate({left:"-="+t},500),i===s-1&&(i=1,$("#galleryFrames .side-index").html(i),a.animate({left:-t+"px"},0))):(i--,$("#galleryFrames .side-index").html(i),a.animate({left:"+="+t},500),0===i&&(i=s-2,$("#galleryFrames .side-index").html(i),a.animate({left:-(t*(s-2))+"px"},0))))}var i=1,n=$("#galleryFrames .slide-prev"),l=$("#galleryFrames .slide-next"),s=$("#galleryFrames li").length,a=$("#galleryFrames ul"),o=$("#galleryFrames .slide-item");$("#galleryFrames .side-max").html(s-2),a.width(t*s),a.css("left",-t),o.width(t),l.on("click",function(){e("right")}),n.on("click",function(){e("left")});var r=setInterval(function(){e("right")},5e3);$("#galleryFrames").on("mouseover",function(){clearTimeout(r)}).on("mouseout",function(){r=setInterval(function(){e("right")},5e3)})})(),function(){function t(){var t=i.children("span").text(),n=o.val(),l="/?cityName="+encodeURIComponent(t)+"&&search="+encodeURIComponent(n);e(l,"GET",function(e){var t=e||[];a.html("");for(var i=0;i<t.length;i++)a.append('<li><a href="javascript:;">'+t[i]+"</a></li>");s.css("display","block")})}var i=$("#citySearch"),n=$("#citiesList"),l=$("#citySug"),s=$("#citySug .city-suggestion-list"),a=$("#citySug .auto-tip"),o=$("#citySug input");n.outerWidth(i.width()+l.width()),i.children("span").on("click",function(){"none"===n.css("display")?n.css("display","block"):n.css("display","none")}),$(".cities-list-hd").on("click","li",function(){var e=$(this).attr("index");$(this).addClass("on").siblings().removeClass("on"),n.find(".cities-list-item").eq(e-1).addClass("active").siblings().removeClass("active")}),$("#citiesList .cities-list-item").on("click","a",function(){i.children("span").html($(this).html()),n.css("display","none"),o.val("")}),o.on("focus",function(){t(),n.css("display","none")}),o.keyup(function(e){t()}),s.on("mousedown","a",function(){o.val($(this).html()),s.css("display","none")}),o.on("blur",function(){s.css("display","none")})}()})()});